<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>林晚的小站</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="shortcut icon"
      href="./assets/ico/favicon.ico"
      type="image/x-icon"
    />
    <link rel="stylesheet" href="./assets/css/index.css" />
  </head>
  <body>
    <div class="layout">
      <div class="pageWrapper" id="pageWrapper"></div>
    </div>
    <script id="listTemplate" type="text/x-handlebars-template">
      {{#each list}}
        <div class="group">
          <div class="titleWrapper">
            <span class="title">{{this.title}}</span>
            {{#if this.time}}
              <span class="time">{{this.time}}</span>
            {{/if}}
          </div>
          {{#each this.items}}
            <a href="{{this.url}}">
              <div
                class="item lozad"
                data-background="./assets/images/tiny/{{this.coverImg}}"
              >
                <div class="mask"></div>
                {{#if this.iconImg}}
                  <div
                    class="icon"
                    style="background-image: url(./assets/images/{{this.iconImg}})"
                  ></div>
                {{/if}}
                <div class="textWrapper">
                  <span class="name">{{this.name}}</span>
                  {{#if this.time}}
                    <span class="time">{{this.time}}</span>
                  {{/if}}
                </div>
              </div>
            </a>
          {{/each}}
        </div>
      {{/each}}
    </script>
    <script src="./assets/js/handlebars-4.7.7.min.js"></script>
    <script src="./assets/js/lozad-1.16.0.min.js"></script>
    <script>
      function formate(data) {
        data.list.forEach((group) => {
          group.items.forEach((item) => {
            item.url = location.host ? item.remoteUrl : item.localUrl;
          });
        });
      }

      // 准备数据
      var data = {
        list: [
          {
            title: "歌词控 demo",
            time: "2011年",
            items: [
              {
                name: "主页",
                coverImg: "gckong.png",
                remoteUrl: "./gckong-demo",
                localUrl: "./gckong-demo/index.html",
              },
              {
                name: "词画·配",
                coverImg: "gckong_chp.png",
                remoteUrl: "./gckong-demo/chp",
                localUrl: "./gckong-demo/chp/index.html",
              },
              {
                name: "聆听·林",
                coverImg: "gckong_ltl.png",
                remoteUrl: "./gckong-demo/ltl",
                localUrl: "./gckong-demo/ltl/index.html",
              },
              /* {
                name: "歌词百科",
                coverImg: "gckong_gcbk.png",
                remoteUrl: "./gckong-demo/gcbk",
                localUrl: "./gckong-demo/gcbk/index.html",
              },
              {
                name: "鹦鹉歌词",
                coverImg: "gckong_ywgc.png",
                remoteUrl: "./gckong-demo/ywgc",
                localUrl: "./gckong-demo/ywgc/index.html",
              }, */
            ],
          },
          {
            title: "白纸黑字 App",
            time: "2015年",
            items: [
              {
                name: "欢迎屏",
                coverImg: "bzhz_welcome.png",
                remoteUrl: "./bzhz/welcome",
                localUrl: "./bzhz/welcome/index.html",
              },
              {
                name: "下载页",
                coverImg: "bzhz_download.png",
                iconImg: "icon-motion.png",
                remoteUrl: "./bzhz/download",
                localUrl: "./bzhz/download/index.html",
              },
            ],
          },
          {
            title: "林晚的家",
            time: "2024年",
            items: [
              {
                name: "Realsee VR",
                coverImg: "realsee_vr.png",
                iconImg: "icon-vr.png",
                remoteUrl: "./realsee-vr",
                localUrl: "./realsee-vr/index.html",
              },
            ],
          },
          {
            title: "全景画",
            time: "2017年",
            items: [
              {
                name: "原型 demo",
                coverImg: "panorama.png",
                iconImg: "icon-360.png",
                remoteUrl: "./panorama",
                localUrl: "./panorama/index.html",
              },
              {
                name: "仿淘宝造物节",
                coverImg: "panorama_tao.png",
                iconImg: "icon-360.png",
                remoteUrl: "./panorama?page=tao",
                localUrl: "./panorama/index.html?page=tao",
              },
              {
                name: "仿安踏广告",
                coverImg: "panorama_anta.png",
                iconImg: "icon-360.png",
                remoteUrl: "./panorama?page=anta",
                localUrl: "./panorama/index.html?page=anta",
              },
            ],
          },
          {
            title: "喜帖",
            time: "2017年",
            items: [
              {
                name: "杭州版本",
                coverImg: "wedding_invitation.png",
                remoteUrl: "./wedding-invitation",
                localUrl: "./wedding-invitation/index.html",
              },
              {
                name: "荆州版本",
                coverImg: "wedding_invitation.png",
                remoteUrl: "./wedding-invitation?location=hubei",
                localUrl: "./wedding-invitation/index.html?location=hubei",
              },
            ],
          },
          {
            title: "爱心代码",
            time: "2022年",
            items: [
              {
                name: "Heart",
                coverImg: "love_code.png",
                remoteUrl: "./love-code",
                localUrl: "./love-code/index.html",
              },
            ],
          },
          {
            title: "哥哥纪念动画",
            time: "2014年",
            items: [
              {
                name: "Leslie",
                coverImg: "leslie.png",
                remoteUrl: "./leslie",
                localUrl: "./leslie/index.html",
              },
            ],
          },
        ],
      };

      formate(data);

      // 获取模板
      var source = document.getElementById("listTemplate").innerHTML;
      // 编译模板
      var template = Handlebars.compile(source);
      // 渲染模板并将结果插入到指定容器中
      var html = template(data);
      document.getElementById("pageWrapper").innerHTML = html;

      // 图片懒加载
      const observer = lozad(".lozad", {
        rootMargin: "100px 0px",
        load: function (el) {
          el.style.backgroundImage = `url(${el.dataset.background})`;
        },
      });
      observer.observe();
    </script>
  </body>
</html>
